@* ======================================================================
   Partial: _AddUserModal
   ----------------------------------------------------------------------
   Purpose
   - Bootstrap 5 modal for adding a new AAD user.
   - Uses AIMS design system classes (aimsds-*) for consistent styling.

   Behavior
   - Cannot close by clicking outside or pressing Esc.
   - Only closes on “X” button or successful form submission.

   Dependencies
   - Requires Bootstrap JS (for data-bs-dismiss, fade transitions).
   - Requires ~/css/components/_AdminModals.css for AIMS theming.
   ====================================================================== *@

<div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserTitle" aria-hidden="true"
    data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content aimsds-shell">
            <div class="modal-header aimsds-header">
                <h4 class="modal-title" id="addUserTitle">Add New User</h4>
                <button type="button" class="btn-close aimsds-close" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>

            <div class="modal-body aimsds-body">
                <form id="addUserForm" onsubmit="AIMS.Admin.addUser(event)">
                     <!-- Hidden: holds the Azure AD object id from the picker -->
                    <input type="hidden" id="graphObjectId" name="graphObjectId" />
                    <label for="userName" class="form-label fw-bold">Name</label>
                    <input type="text" id="userName" class="form-control" placeholder="Start typing a name.."
                        autocomplete="off" />
                    <div id="aadUserResults" class="aad-user-results"></div>

                    <label for="userEmail" class="form-label fw-bold mt-2">Email</label>
                    <input type="email" id="userEmail" class="form-control" required />

                    <label for="userRole" class="form-label fw-bold mt-2">Role</label>
                    <select id="userRole" class="form-select">
                    <option value="">-- choose --</option>
                    <option value="1">Admin</option>
                    <option value="2">Supervisor</option>
                    <option value="3">User</option>
                    </select>

                    <label for="userOffice" class="form-label fw-bold mt-2">Office</label>
                    <input type="text" id="userOffice" class="form-control" required />

                    <label for="userStatus" class="form-label fw-bold mt-2">Status</label>
                    <select id="userStatus" class="aims-select" required>
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                    </select>
                    <div id="userExistsNotice" class="text-danger d-none" role="alert">
                    User is already in the system.
                                            </div>

                    <button type="submit" class="add-btn mt-4 w-100">Add User</button>
                </form>
            </div>
        </div>
    </div>
</div>
