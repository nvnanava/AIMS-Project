@* ======================================================================
   Partial: _EditUserModal
   ----------------------------------------------------------------------
   Purpose
   - Bootstrap 5 modal for editing an existing user.
   - Uses AIMS design system classes (aimsds-*) for consistent styling.

   Behavior
   - Cannot close by clicking outside or pressing Esc.
   - Only closes on “X” button or successful form submission.

   Dependencies
   - Requires Bootstrap JS (for data-bs-dismiss, fade transitions).
   - Requires ~/css/components/_AdminModals.css for AIMS theming.
   ====================================================================== *@

<div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserTitle" aria-hidden="true"
    data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content aimsds-shell">
            <div class="modal-header aimsds-header">
                <h4 class="modal-title" id="editUserTitle">Edit User</h4>
                <button type="button" class="btn-close aimsds-close" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>

            <div class="modal-body aimsds-body">
                <button class="btn btn-mint px-4" type="button" id="refreshUserBtn">
                    <i class="bi bi-person-plus"></i> Refresh User from Azure
                </button>
                <div id="refreshUserStatus" class="office-results"></div>
                <form id="editUserForm" onsubmit="AIMS.Admin.saveUserEdit(event)">
                    <input type="hidden" id="userGraphId" />
                    <input type="hidden" id="editUserId" />
                    <input type="hidden" id="editUserIsArchived" />
                    <input type="hidden" id="oldOffice" />
                    <input type="hidden" id="editUserIndex" />

                    <label for="editUserName" class="form-label fw-bold">Name</label>
                    <input type="text" id="editUserName" class="form-control" required />

                    <label for="editUserEmail" class="form-label fw-bold mt-2">Email</label>
                    <input type="email" id="editUserEmail" class="form-control" required />

                    <label for="editUserRole" class="form-label fw-bold mt-2">Role</label>
                    <select id="editUserRole" class="aims-select" required>
                        <option value="Admin">Admin</option>
                        <option value="User">User</option>
                    </select>

                    <label for="editUserOffice" class="form-label fw-bold mt-2">Office</label>
                    <input type="text" id="editUserOffice" class="form-control" required />
                    <div id="editOfficeResults" class="office-results"></div>

                    <label for="editUserStatus" class="form-label fw-bold mt-2">Archive Status</label>
                    <select id="editUserStatus" class="aims-select" required>
                        <option value="Active">Active (Not Archived)</option>
                        <option value="Inactive">Archived</option>
                    </select>

                    <label for="editUserSeparationDate" class="form-label fw-bold mt-2">Separation Date</label>
                    <input type="text" id="editUserSeparationDate" class="form-control" placeholder="MM/DD/YYYY" />

                    <button type="submit" class="add-btn mt-4 w-100">Save Changes</button>
                </form>
            </div>
        </div>
    </div>
</div>

