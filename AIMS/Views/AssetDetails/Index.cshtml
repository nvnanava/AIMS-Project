@using AIMS.Utilities

@await Html.PartialAsync("_HardwareAddForm")
@await Html.PartialAsync("_EditAssetForm")
@await Html.PartialAsync("_AddCategoryForm")
@await Html.PartialAsync("_SoftwareAddForm")

@section Styles {
    <link rel="stylesheet" href="~/css/pages/assetdetails.index.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/components/_AssetButton.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/components/_AssetAddForm.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/components/_FilterIcon.css" asp-append-version="true" />
}

@{
    var category = ViewData["Category"]?.ToString() ?? "Unknown";
    ViewData["Title"] = $"{category} Asset Details";
}

<div id="assetdetails-config"
     data-specs='@Html.Raw(Json.Serialize(ViewData["SpecsData"] ?? new { }))'
     data-category="@category"
     data-is-admin="@(User.IsAdmin().ToString().ToLower())">
</div>

<h2 class="text-center my-4">@ViewData["Title"]</h2>

<div class="table-wrapper" style="position:relative;width:fit-content;margin:0 auto;padding:10px;">
    <table class="asset-table">
        <thead>
            <tr>
                <th>Asset Name</th>
                <th>Type</th>
                <th id="seatOrTagHeader">Tag #</th>
                <th id="status-col-header">
                    <div class="d-flex align-items-center gap-2">
                        <span>Status</span>
                        @await Html.PartialAsync("_FilterIcon", new ViewDataDictionary(ViewData)
                        {
                            ["Id"] = "detailsFilters",
                            ["Label"] = "Show Archived",
                            ["Checked"] = false
                        })
                    </div>
                </th>

                <th class="manage-asset-col">
                    <div class="manage-asset-wrapper">
                        @if (User.IsAdmin())
                        {
                            @await Html.PartialAsync("_AssetButton")
                        }
                    </div>
                </th>
            </tr>
        </thead>

        <tbody id="assetTableBody"></tbody>
    </table>

    <div id="asset-pager" class="search-pager" hidden>
        <button type="button" id="asset-prev" class="pager-btn">Prev</button>
        <span id="asset-status" class="pager-status"></span>
        <button type="button" id="asset-next" class="pager-btn">Next</button>
    </div>
</div>

<p id="emptyMessage" class="text-center" style="display:none;">
    No assets found for <strong>@category</strong>.
</p>

<div id="popup"
     style="display:none;position:fixed;background:white;padding:12px 16px;border:1.5px solid #ccc;
            border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.15);font-size:0.85rem;
            max-width:220px;width:max-content;word-wrap:break-word;line-height:1.4;z-index:1000;">
</div>

@section Scripts {
    <script src="~/js/components/add-shared.js" asp-append-version="true" defer></script>
    <script src="~/js/pages/assetdetails.index.js" asp-append-version="true" defer></script>
    <script src="~/js/components/add-hardware.js" asp-append-version="true" defer></script>
    <script src="~/js/components/add-software.js" asp-append-version="true" defer></script>
}

